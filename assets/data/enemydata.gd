extends Node


var predeterminatedgroups = {
	forestboss = {weight = 0.1, group = {5 : 'bigtreant'}, code = 'forestboss', music = 'boss'},
	caveboss = {weight = 0.1, group = {2 : 'earthgolemboss'}, code = 'caveboss', music = 'boss'},
	
	
	
}

var randomgroups = {
	foresteasy = {units = {elvenrat = [1,2]}, weight = 1, code = 'foresteasy', reqs = [{type = "party_level", operant = "lte", value = 3}]},
	foresteasymed = {units = {elvenrat = [2,4]}, weight = 1, code = 'foresteasymed', reqs = []},
	forestmedium = {units = {elvenrat = [1,3], treant = [0,1]}, weight = 1, code = 'forestmedium',reqs = [{type = "party_level", operant = "gte", value = 2}]},
	forestmedium2 = {units = {elvenrat = [1,2], treant = [1,2]}, weight = 1, code = 'forestmedium2',reqs = [{type = "party_level", operant = "gte", value = 2}]},
	foresthard = {units = {treant = [2,3], elvenrat = [1,2]}, weight = 1, code = 'foresthard',reqs = [{type = "party_level", operant = "gte", value = 5}]},
	foresthard2 = {units = {spider = [1,2], treant = [1,2]}, weight = 1, code = 'foresthard2',reqs = [{type = "party_level", operant = "gte", value = 4}]},
	foresthard3 = {units = {fairies = [1,1], treant = [1,2]}, weight = 1, code = 'foresthard3',reqs = [{type = "party_level", operant = "gte", value = 4}]},
	forestextraboss = {units = {bigtreant = [1,1], treant = [1,2]}, weight = 0.2, code = 'forestextraboss',reqs = [{type = "party_level", operant = "gte", value = 8}]},
	
	#caves
	
	caveeasy = {units = {spider = [1,2]}, weight = 1, code = 'caveeasy',reqs = [{type = "party_level", operant = "lte", value = 4}]},
	cavemedium = {units = {spider = [1,2], earthgolem = [1,2]}, weight = 1, code = 'cavemedium',reqs = [{type = "party_level", operant = "gte", value = 4}]},
	cavemedium2 = {units = {earthgolem = [1,2], angrydwarf = [1,1]}, weight = 1, code = 'cavemedium2',reqs = [{type = "party_level", operant = "gte", value = 4}]},
	cavemedium3 = {units = {angrydwarf = [2,2]}, weight = 1, code = 'cavemedium3',reqs = [{type = "party_level", operant = "gte", value = 5}]},
	
}

var enemylist = {
	elvenrat = {
		code = 'elvenrat',
		name = tr("MONSTERELVENRAT"),
		flavor = tr("MONSTERELVENRATFLAVOR"),
		race = 'animal',
		skills = ['attack'],
		basehp = 50,
		damage = 20,
		resists = {slash = -50, bludgeon = 50, earth = 50, water = -100, light = -100, dark = 50},
		xpreward = 10,
		bodyhitsound = 'flesh',
		base_dmg_type = 'pierce',
		traits = [],
		combaticon = 'rat',
		bodyimage = null,
		aiposition = 'melee',
		loottable = 'elvenratloot',
		animations = {}
	},
	treant = {
		code = 'treant',
		name = tr(""),
		flavor = tr(""),
		race = 'plant',
		skills = ['attack', 'earth_attack'],
		basehp = 100,
		damage = 23,
		resists = {slash = 50, pierce = 50, fire = -100, earth = 50, water = 150, air = -100, light = 50},
		xpreward = 10,
		bodyhitsound = 'flesh',
		base_dmg_type = 'bludgeon',
		traits = [],
		combaticon = '',
		bodyimage = null,
		aiposition = 'melee',
		loottable = '',
		animations = {}
	},
	faerie = {
		code = 'faerie',
		name = tr(""),
		flavor = tr(""),
		race = 'humanoid',
		skills = ['attack', 'fire_attack', 'f_heal'],
		basehp = 72,
		damage = 35,
		resists = {pierce = -100, bludgeon = 50, earth = 50, water = -100, light = -100},
		xpreward = 10,
		bodyhitsound = 'flesh',
		base_dmg_type = 'air',
		traits = [],
		combaticon = '',
		bodyimage = null,
		aiposition = 'melee',
		loottable = '',
		animations = {}
	},
	spider = {
		code = 'spider',
		name = tr(""),
		flavor = tr(""),
		race = 'insect',
		skills = ['attack', 'poison_spit'],
		basehp = 80,
		damage = 30,
		resists = {slash = -50, pierce = 50, fire = -100, air = -50, dark = 50},
		xpreward = 10,
		bodyhitsound = 'flesh',
		base_dmg_type = 'pierce',
		traits = [],
		combaticon = '',
		bodyimage = null,
		aiposition = 'melee',
		loottable = '',
		animations = {}
	},
	earthgolem = {
		code = 'earthgolem',
		name = tr(""),
		flavor = tr(""),
		race = 'rock',
		skills = ['attack', 'earth_aoe'],
		basehp = 125,
		damage = 28,
		resists = {slash = 50, pierce = 50, bludgeon = -50, earth = 150, water = -100, air = 50, light = 50, dark = 50},
		xpreward = 10,
		bodyhitsound = 'flesh',
		base_dmg_type = 'earth',
		traits = [],
		combaticon = '',
		bodyimage = null,
		aiposition = 'melee',
		loottable = '',
		animations = {}
	},
	angrydwarf = {
		code = 'angrydwarf',
		name = tr(""),
		flavor = tr(""),
		race = 'humanoid',
		skills = ['attack', 'earth_attack'],
		basehp = 115,
		damage = 33,
		resists = {slash = -50, bludgeon = 50, fire = -100, earth = 50, water = -100, dark = -100},
		xpreward = 10,
		bodyhitsound = 'flesh',
		base_dmg_type = 'slash',
		traits = ['dw_enrage'],
		combaticon = '',
		bodyimage = null,
		aiposition = 'melee',
		loottable = '',
		animations = {}
	},
	dwarf = {
		code = 'dwarf',
		name = tr(""),
		flavor = tr(""),
		race = 'humanoid',
		skills = ['attack', 'earth_attack'],
		basehp = 135,
		damage = 30,
		resists = {slash = 100, pierce = 50, bludgeon = -50, earth = 100, water = -50, air = -100, light = -100},
		xpreward = 10,
		bodyhitsound = 'flesh',
		base_dmg_type = 'slash',
		traits = ['dw_enrage'],
		combaticon = '',
		bodyimage = null,
		aiposition = 'melee',
		loottable = '',
		animations = {}
	},
	zombie = {
		code = 'zombie',
		name = tr(""),
		flavor = tr(""),
		race = 'undead',
		skills = ['attack', 'poison_breath'],
		basehp = 120,
		damage = 40,
		resists = {slash = -50, pierce = 50, bludgeon = 100, fire = -100, earth = 50, water = 100, light = -100},
		xpreward = 10,
		bodyhitsound = 'flesh',
		base_dmg_type = 'blunt',
		traits = [],
		combaticon = '',
		bodyimage = null,
		aiposition = 'melee',
		loottable = '',
		animations = {}
	},
	skeleton_warrior = {
		code = 'skeleton_warrior',
		name = tr(""),
		flavor = tr(""),
		race = 'undead',
		skills = ['attack', 'air_attack', 'dark_attack'],
		basehp = 125,
		damage = 45,
		resists = {pierce = 100, bludgeon = -100, fire = 50, earth = -100, water = -100, air = -100, light = -100},
		xpreward = 10,
		bodyhitsound = 'flesh',
		base_dmg_type = 'slash',
		traits = ['wounds'],
		combaticon = '',
		bodyimage = null,
		aiposition = 'melee',
		loottable = '',
		animations = {}
	},
	skeleton_archer = {
		code = 'skeleton_archer',
		name = tr(""),
		flavor = tr(""),
		race = 'undead',
		skills = ['attack', 'fire_attack', 'dark_attack'],
		basehp = 111,
		damage = 62,
		resists = {pierce = 100, bludgeon = -100, fire = 50, earth = -100, water = -100, air = -100, light = -100},
		xpreward = 10,
		bodyhitsound = 'flesh',
		base_dmg_type = 'pierce',
		base_dmg_range = 'any',
		traits = [],
		combaticon = '',
		bodyimage = null,
		aiposition = 'ranged',
		loottable = '',
		animations = {}
	},
	wraith = {
		code = 'wraith',
		name = tr(""),
		flavor = tr(""),
		race = 'undead',
		skills = ['attack', 'air_attack'],
		basehp = 95,
		damage = 65,
		resists = {slash = 100, pierce = 100, bludgeon = 100, fire = -100, earth = 100, water = -100, air = -100, light = -100, dark = 100},
		xpreward = 10,
		bodyhitsound = 'flesh',
		base_dmg_type = 'dark',
		traits = [],
		combaticon = '',
		bodyimage = null,
		aiposition = 'melee',
		loottable = '',
		animations = {}
	},
	cult_soldier = {
		code = 'cult_soldier',
		name = tr(""),
		flavor = tr(""),
		race = 'humanoid',
		skills = ['attack', 'light_attack', 'pierce_attack', 'guard'],
		basehp = 106,
		damage = 63,
		resists = {slash = 50, pierce = -50, fire = 50, earth = -100, light = -100, dark = 50},
		xpreward = 10,
		bodyhitsound = 'flesh',
		base_dmg_type = 'slash',
		traits = [],
		combaticon = '',
		bodyimage = null,
		aiposition = 'melee',
		loottable = '',
		animations = {}
	},
	cult_mage = {
		code = 'cult_mage',
		name = tr(""),
		flavor = tr(""),
		race = 'humanoid',
		skills = ['attack', 'fire_attack', 'c_heal'],
		basehp = 106,
		damage = 63,
		resists = {slash = -100, bludgeon = 50, fire = 50, earth = -50, water = 50, air = -50, light = 100, dark = -100},
		xpreward = 10,
		bodyhitsound = 'flesh',
		base_dmg_type = 'air',
		base_dmg_range = 'any',
		traits = [],
		combaticon = '',
		bodyimage = null,
		aiposition = 'ranged',
		loottable = '',
		animations = {}
	},
	cult_archer = {
		code = 'cult_archer',
		name = tr(""),
		flavor = tr(""),
		race = 'humanoid',
		skills = ['attack', 'fire_attack', 'c_heal'],
		basehp = 112,
		damage = 58,
		resists = {slash = -100, pierce = 50, fire = -100, earth = 50, water = 100, air = -100, light = -100},
		xpreward = 10,
		bodyhitsound = 'flesh',
		base_dmg_type = 'pierce',
		base_dmg_range = 'any',
		traits = [],
		combaticon = '',
		bodyimage = null,
		aiposition = 'ranged',
		loottable = '',
		animations = {}
	},
	hatchling = {
		code = 'hatchling',
		name = tr(""),
		flavor = tr(""),
		race = 'dragon',
		skills = ['attack', 'fire_breath'],
		basehp = 100,
		damage = 42,
		resists = {slash = -100, bludgeon = 50, fire = 100, earth = -100, water = -100, air = 50, light = -100, dark = 50},
		xpreward = 10,
		bodyhitsound = 'flesh',
		base_dmg_type = 'fire',
		traits = [],
		combaticon = '',
		bodyimage = null,
		aiposition = 'melee',
		loottable = '',
		animations = {}
	},
	wyvern = {
		code = 'wyvern',
		name = tr(""),
		flavor = tr(""),
		race = 'dragon',
		skills = ['attack', 'fire_breath', 'tail_swipe'],
		basehp = 150,
		damage = 55,
		resists = {slash = 50, pierce = -100, bludgeon = 50, fire = 50, earth = 50, water = -100, air = -100, light = 50, dark = -100},
		xpreward = 10,
		bodyhitsound = 'flesh',
		base_dmg_type = 'pierce',
		traits = [],
		combaticon = '',
		bodyimage = null,
		aiposition = 'melee',
		loottable = '',
		animations = {}
	},
	armored_beast = {
		code = 'armored_beast',
		name = tr(""),
		flavor = tr(""),
		race = 'animal',
		skills = ['attack', 'earth_attack', 'roar'],
		basehp = 180,
		damage = 44,
		resists = {slash = 100, bludgeon = -100, fire = -100, earth = 100, water = -100, air = 100, light = -100, dark = 50},
		xpreward = 10,
		bodyhitsound = 'flesh',
		base_dmg_type = 'blunt',
		traits = [],
		combaticon = '',
		bodyimage = null,
		aiposition = 'melee',
		loottable = '',
		animations = {}
	},
	giant_toad = {
		code = 'giant_toad',
		name = tr(""),
		flavor = tr(""),
		race = 'animal',
		skills = ['attack', 'poison_spit', 'waterspray'],
		basehp = 130,
		damage = 52,
		resists = {pierce = 50, bludgeon = -100, fire = 50, earth = -100, water = 100, air = -100, light = 50, dark = -100},
		xpreward = 10,
		bodyhitsound = 'flesh',
		base_dmg_type = 'water',
		traits = [],
		combaticon = '',
		bodyimage = null,
		aiposition = 'melee',
		loottable = '',
		animations = {}
	},
	demon1 = {
		code = 'demon1',
		name = tr(""),
		flavor = tr(""),
		race = 'demon',
		skills = ['attack', 'heavystrike'],
		basehp = 150,
		damage = 66,
		resists = {slash = 50, pierce = -100, bludgeon = 50, fire = 0, earth = 50, water = 50, air = -100, light = -100, dark = 50},
		xpreward = 10,
		bodyhitsound = 'flesh',
		base_dmg_type = 'slash',
		traits = [],
		combaticon = '',
		bodyimage = null,
		aiposition = 'melee',
		loottable = '',
		animations = {}
	},
	demon2 = {
		code = 'demon2',
		name = tr(""),
		flavor = tr(""),
		race = 'demon',
		skills = ['attack', 'fire_attack', 'impale'],
		basehp = 190,
		damage = 48,
		resists = {slash = -100, pierce = 100, bludgeon = -100, fire = 50, earth = -100, water = -100, air = 50, light = -100, dark = 100},
		xpreward = 10,
		bodyhitsound = 'flesh',
		base_dmg_type = 'dark',
		traits = [],
		combaticon = '',
		bodyimage = null,
		aiposition = 'melee',
		loottable = '',
		animations = {}
	},
	soldier = {
		code = 'soldier',
		name = tr(""),
		flavor = tr(""),
		race = 'demon',
		skills = ['attack', 'light_attack'],
		basehp = 180,
		damage = 70,
		resists = {slash = -100, pierce = 50, bludgeon = 100, fire = 50, earth = -100, water = 100, air = -100, light = 50, dark = -100},
		xpreward = 10,
		bodyhitsound = 'flesh',
		base_dmg_type = 'pierce',
		traits = [],
		combaticon = '',
		bodyimage = null,
		aiposition = 'melee',
		loottable = '',
		animations = {}
	},
	
	
	
	bomber = {
		code = 'bomber',
		name = tr("MONSTERELVENRAT"),
		flavor = tr("MONSTERELVENRATFLAVOR"),
		race = 'animal',
		skills = ['attack'],
		passives = [],
		basehp = 50,
		basemana = 0,
		armor = 0,
		armorpenetration = 0,
		mdef = 0,
		evasion = 0,
		hitrate = 80,
		damage = 15,
		speed = 50,
		resists = {},
		xpreward = 10,
		
		bodyhitsound = 'flesh',
		traits = ['unstable'],
		combaticon = 'rat',
		bodyimage = null,
		aiposition = 'melee',
		loottable = 'elvenratloot',
		animations = {}
	},
	scientist = {
		code = 'scientist',
		name = tr("MONSTERELVENRAT"),
		flavor = tr("MONSTERELVENRATFLAVOR"),
		race = 'animal',
		skills = ['sc_summon1', 'sc_shatter', 'en_enburst', 'en_thrust'],
		passives = [],
		basehp = 500,
		basemana = 0,
		armor = 0,
		armorpenetration = 0,
		mdef = 0,
		evasion = 0,
		hitrate = 80,
		damage = 15,
		speed = 50,
		resists = {},
		xpreward = 10,
		ai = load('res://files/ai_classes/scientist.gd').new(),
		
		bodyhitsound = 'flesh',
		traits = ['unstable'],
		combaticon = 'rat',
		bodyimage = null,
		aiposition = 'melee',
		loottable = 'elvenratloot',
		animations = {}
	},
	
	
	
#	treant = {
#		code = 'treant',
#		name = tr("MONSTERTREANT"),
#		flavor = tr("MONSTERTREANTFLAVOR"),
#		race = 'plant',
#		skills = ['attack'],
#		passives = [],
#		traits = ['treant_barrier'],
#		basehp = 75,
#		basemana = 0,
#		armor = 0,
#		armorpenetration = 0,
#		mdef = 0,
#		evasion = 0,
#		hitrate = 75,
#		damage = 30,
#		speed = 30,
#		resists = {},
#		xpreward = 10,
#
#		bodyhitsound = 'wood',
#
#		combaticon = 'ent',
#		bodyimage = null,
#		aiposition = 'melee',
#		loottable = 'treantloot',
#	},
	bigtreant = {
		code = 'bigtreant',
		name = tr("MONSTERBIGTREANT"),
		flavor = tr("MONSTERBIGTREANTFLAVOR"),
		race = 'plant',
		skills = ['attack', 'summontreant'],
		passives = [],
		basehp = 300,
		basemana = 100,
		armor = 0,
		armorpenetration = 0,
		mdef = 0,
		evasion = 0,
		hitrate = 70,
		damage = 60,
		speed = 20,
		resists = {},
		xpreward = 50,
		
		bodyhitsound = 'wood',
		
		combaticon = 'bigent',
		bodyimage = null,
		aiposition = 'ranged',
		loottable = 'bigtreantloot',
		animations = {}
	},
#	earthgolem = {
#		code = 'earthgolem',
#		name = tr("MONSTEREARTHGOLEM"),
#		flavor = tr("MONSTEREARTHGOLEMFLAVOR"),
#		race = 'rock',
#		skills = ['attack','golemattack'],
#		passives = [],
#		traits = ['el_heal'],
#		basehp = 100,
#		basemana = 0,
#		armor = 50,
#		armorpenetration = 0,
#		mdef = 10,
#		evasion = 0,
#		hitrate = 80,
#		damage = 50,
#		speed = 30,
#		resists = {earth = 50, air = 25},
#		xpreward = 30,
#
#		bodyhitsound = 'stone',
#
#		combaticon = 'golem',
#		bodyimage = null,
#		aiposition = 'melee',
#		loottable = 'earthgolemloot',
#	},
	earthgolemboss = {
		code = 'earthgolemboss',
		name = tr("MONSTEREARTHGOLEMBOSS"),
		flavor = tr("MONSTEREARTHGOLEMBOSSFLAVOR"),
		race = 'rock',
		skills = ['attack','golemattack'],
		passives = [],
		traits = [],
		basehp = 450,
		basemana = 0,
		armor = 35,
		armorpenetration = 0,
		mdef = 15,
		evasion = 0,
		hitrate = 95,
		damage = 100,
		speed = 30,
		resists = {earth = 50, air = 25},
		xpreward = 50,
		
		bodyhitsound = 'stone',
		
		combaticon = 'golemalt',
		bodyimage = null,
		aiposition = 'melee',
		loottable = 'earthgolembossloot',
		animations = {}
	},
	
#	spider = {
#		code = 'spider',
#		name = tr("MONSTERSPIDER"),
#		flavor = tr("MONSTERSPIDERFLAVOR"),
#		race = 'animal',
#		skills = ['spiderattack'],
#		passives = [],
#		basehp = 75,
#		basemana = 0,
#		armor = 0,
#		armorpenetration = 15,
#		mdef = 15,
#		evasion = 40,
#		hitrate = 75,
#		damage = 30,
#		speed = 40,
#		resists = {},
#		xpreward = 20,
#
#		bodyhitsound = 'flesh',
#
#		combaticon = 'spider',
#		bodyimage = null,
#		aiposition = 'melee',
#		loottable = 'spiderloot',
#	},
#	fairies = {
#		code = 'fairies',
#		name = tr("MONSTERFAIRIES"),
#		flavor = tr("MONSTERFAIRIESFLAVOR"),
#		race = 'humanoid',
#		skills = ['fairyattack'],
#		passives = [],
#		basehp = 100,
#		basemana = 0,
#		armor = 0,
#		armorpenetration = 0,
#		mdef = 25,
#		evasion = 50,
#		hitrate = 75,
#		damage = 40,
#		speed = 60,
#		resists = {},
#		xpreward = 20,
#
#		bodyhitsound = 'flesh',
#
#		combaticon = 'fairies',
#		bodyimage = null,
#		aiposition = 'ranged',
#		loottable = 'fairiesloot',
#	},
#	angrydwarf = {
#		code = 'angrydwarf',
#		name = tr("MONSTERANGRYDWARF"),
#		flavor = tr("MONSTERANGRYDWARFFLAVOR"),
#		race = 'humanoid',
#		skills = ['attack'],
#		passives = [],
#		traits = ['dw_fury'],
#		basehp = 150,
#		basemana = 0,
#		armor = 20,
#		armorpenetration = 0,
#		mdef = 0,
#		evasion = 0,
#		hitrate = 80,
#		damage = 75,
#		speed = 45,
#		resists = {},
#		xpreward = 20,
#
#		bodyhitsound = 'flesh',
#
#		combaticon = 'dwarf',
#		bodyimage = null,
#		aiposition = 'melee',
#		loottable = 'angrydwarfloot',
#	},

}







var loottables = {
	elvenratloot = {
		materials = [{code = 'leather', min = 1, max = 1, chance = 35}, {code = 'bone', min = 1, max = 1, chance = 25}],
		usables = [{code = 'morsel', min = 1, max = 1, chance = 25}],
	},
	treantloot = {
		materials = [{code = 'wood', min = 1, max = 1, chance = 25}],
		usables = [{code = 'managrass', min = 1, max = 1, chance = 15}],
	},
	bigtreantloot = {
		materials = [{code = 'wood', min = 3, max = 7, chance = 100}, {code = 'elvenwood', min = 3, max = 5, chance = 100}],
		usables = [{code = 'managrass', min = 1, max = 3, chance = 100}],
	},
	spiderloot = {
		materials = [{code = 'cloth', min = 1, max = 1, chance = 35}],
		usables = [{code = 'morsel', min = 1, max = 1, chance = 35}],
	},
	earthgolemloot = {
		materials = [{code = 'goblinmetal', min = 1, max = 2, chance = 35},{code = 'elvenmetal', min = 1, max = 1, chance = 15}],
		usables = [{code = 'protectivecharm', min = 1, max = 1, chance = 10}],
	},
	fairiesloot = {
		usables = [{code = 'managrass', min = 1, max = 2, chance = 25},{code = 'lesserpotion', min = 1, max = 1, chance = 15},{code = 'protectivecharm', min = 1, max = 1, chance = 10}],
	},
	angrydwarfloot = {
		materials = [{code = 'goblinmetal', min = 1, max = 1, chance = 35}],
		usables = [{code = 'morsel', min = 1, max = 1, chance = 15}],
	},
	earthgolembossloot = {
		materials = [{code = 'goblinmetal', min = 4, max = 7, chance = 100},{code = 'elvenmetal', min = 3, max = 5, chance = 100}],
		usables = [{code = 'protectivecharm', min = 1, max = 1, chance = 100}],
	},
}


func _ready():
	yield(preload_icons(), 'completed')
	print("Enemies icons preloaded")


func preload_icons():
	for ch in enemylist.values():
#		if b.icon.begins_with("res:"): continue
		if ch.combaticon != null:
			resources.preload_res(ch.combaticon)
		if ch.bodyimage != null:
			resources.preload_res(ch.bodyimage)
		for an in ch.animations.values():
			if an is AnimatedTexAutofill:
				an.fill_frames()
			else:
				resources.preload_res(an)
	yield(resources, "done_work")
